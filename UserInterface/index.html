<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luxury Tourism - Home</title>
  <script src="config.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {
      background-color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
      color: #333333;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    .navbar {
      padding: 1rem 1.9rem; 
    }
    .navbar-brand {
      font-size: 1.5rem; 
    }
    .nav-link {
      font-size: 1.1rem; 
      padding: 0.5rem 1rem; 
    }
    .btn-outline-light {
      padding: 0.5rem 1rem; 
      font-size: 1.1rem;
    }
    
    .offcanvas {
      width: 400px; 
    }
    .offcanvas-title {
      font-size: 1.6rem; 
    }
    .offcanvas-body .nav-link {
      font-size: 1.1rem; 
      padding: 0.75rem 1.6rem;
    }
    .offcanvas-body .nav-link i {
      font-size: 1.9rem; 
      width: 50px; 
    }

    .hero {
      background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e');
      background-size: cover;
      background-position: center;
      height: 70vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.9);
      animation: backgroundShift 30s ease-in-out infinite;
    }
    @keyframes backgroundShift {
      0% { background-position: center top; }
      50% { background-position: center bottom; }
      100% { background-position: center top; }
    }
    h2 {
      margin-top: 30px;
      margin-bottom: 20px;
      text-align: left;
      font-weight: 700;
      font-size: 2.2rem;
      color: #2c2c2c;
      position: relative;
    }
    h2::after {
      content: "";
      display: block;
      width: 50px;
      height: 3px;
      background: #0d6efd;
      margin: 5px 0 0 0;
      border-radius: 2px;
    }
    .card-slider-container {
      overflow: hidden;
      position: relative;
      width: 100%;
      margin-bottom: 20px;
    }
    .card-slider {
      display: flex;
      gap: 10px;
      transition: transform 0.5s ease-in-out;
    }
    .card-slider .card {
      min-width: 250px;
      max-width: 250px;
      height: 420px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow:
        0 4px 6px rgba(0,0,0,0.1),
        0 8px 15px rgba(13, 110, 253, 0.15);
      cursor: pointer;
      background-color: #fff;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card-slider .card:hover {
      transform: scale(1.05) translateY(-5px);
      box-shadow:
        0 10px 15px rgba(0,0,0,0.2),
        0 20px 30px rgba(13, 110, 253, 0.3);
      z-index: 10;
    }
    .card-slider .card img {
      height: 200px;
      width: 100%;
      object-fit: cover;
      border-bottom: 3px solid #0d6efd;
    }
    .card-body {
      padding: 15px 12px;
      font-size: 1rem;
      font-weight: 600;
      color: #2c2c2c;
      text-align: left;
      user-select: none;
    }
    .card-body p {
      font-size: 0.85rem;
      font-weight: 400;
      color: #666;
      margin-top: 5px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
    }
    .card-body .details {
      font-size: 0.8rem;
      color: #777;
      margin-top: 5px;
    }
    .card-body .rating {
      margin-top: 5px;
      color: #ffca08;
      font-size: 0.9rem;
    }
    #heroStartJourney {
      background-color: #0d6efd;
      border: none;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }
    #heroStartJourney:hover,
    #heroStartJourney:focus {
      background-color: #0842c7;
      color: #fff;
    }
    footer {
      background-color: #1f1f2e;
      color: #ccc;
      width: 100%;
      padding: 20px 0;
      margin-top: auto;
    }
    .hero {
      text-align: left;
      padding-left: 40px;
    }
    .hero > div {
      max-width: 600px;
    }
    .main-content {
      flex: 1 0 auto;
      padding-bottom: 20px;
    }
    .container {
      max-width: 100%;
      padding: 0 30px;
    }
  </style>
</head>
<body>

<nav class="navbar navbar-dark bg-dark">
  <div class="container-fluid">
    <button class="btn btn-outline-light me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar">
      <i class="fas fa-bars"></i>
    </button>
    <a class="navbar-brand me-auto" href="#">🌍 Ametia Tourism</a>
    <ul class="navbar-nav flex-row gap-3">
      <li class="nav-item"><a class="nav-link text-light" href="index.html">Home</a></li>
      <li class="nav-item"><a class="nav-link text-light" href="about.html">About</a></li>
      <li class="nav-item"><a class="nav-link text-light" href="services.html">Services</a></li>
    </ul>
  </div>
</nav>

<div class="offcanvas offcanvas-start text-bg-dark" tabindex="-1" id="sidebar" aria-labelledby="sidebarLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sidebarLabel">Ametia Panel</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="nav flex-column">
      <li><a href="Profile.html" class="nav-link text-light"><i class="fas fa-users me-2"></i>Profile</a></li>
      <li><a href="Banks.html" class="nav-link text-light"><i class="fas fa-university me-2"></i>Banks</a></li>
      <li><a href="Cities.html" class="nav-link text-light"><i class="fas fa-city me-2"></i>Cities</a></li>
      <li><a href="Embasses.html" class="nav-link text-light"><i class="fas fa-building me-2"></i>Embasses</a></li>
      <li><a href="EntertainmentPlace.html" class="nav-link text-light"><i class="fas fa-film me-2"></i>Entertainment</a></li>
      <li><a href="Hotel.html" class="nav-link text-light"><i class="fas fa-hotel me-2"></i>Hotel</a></li>
      <li><a href="Restaurant.html" class="nav-link text-light"><i class="fas fa-utensils me-2"></i>Restaurant</a></li>
      <li><a href="TourismPlace.html" class="nav-link text-light"><i class="fas fa-map-marked-alt me-2"></i>Tourism</a></li>
      <li><a href="#" class="nav-link text-light" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
    </ul>
  </div>
</div>

<div class="main-content">
  <div class="hero text-center">
    <div>
      <h1 class="display-4">Discover the Most Beautiful Destinations</h1>
      <p class="lead">Luxury hotels and resorts are waiting for you</p>
      <button class="btn btn-light btn-lg mt-3" id="heroStartJourney">Start Your Journey</button>
    </div>
  </div>

  <div class="container my-5" id="places">
    <div id="sections"></div>
  </div>
</div>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-3">
        <h5>Ametia Travel</h5>
        <p>Explore the best tourist destinations, restaurants, hotels, and more with our guided services. Your journey begins here.</p>
      </div>
      <div class="col-md-3">
        <h5>Navigation</h5>
        <ul class="list-unstyled">
          <li><a href="index.html" style="color: #bbb; text-decoration: none;">🏠 Home</a></li>
          <li><a href="Cities.html" style="color: #bbb; text-decoration: none;">🏙️ Cities</a></li>
          <li><a href="Contact.html" style="color: #bbb; text-decoration: none;">📞 Contact Us</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Services</h5>
        <ul class="list-unstyled">
          <li><a href="#" style="color: #bbb; text-decoration: none;">🛎️ Customer Support</a></li>
          <li><a href="#" style="color: #bbb; text-decoration: none;">🔒 Privacy Policy</a></li>
          <li><a href="#" style="color: #bbb; text-decoration: none;">📜 Terms of Use</a></li>
          <li><a href="#" style="color: #bbb; text-decoration: none;">💼 Partners</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Follow Us</h5>
        <div style="display: flex; gap: 10px; font-size: 20px;">
          <a href="#" style="color: #bbb;"><i class="fab fa-facebook-f"></i></a>
          <a href="#" style="color: #bbb;"><i class="fab fa-twitter"></i></a>
          <a href="#" style="color: #bbb;"><i class="fab fa-instagram"></i></a>
          <a href="#" style="color: #bbb;"><i class="fab fa-youtube"></i></a>
        </div>
      </div>
    </div>
    <div style="text-align: center; padding-top: 15px; font-size: 13px; color: #888;">
      © 2025 Ametia Tourism. All rights reserved.
    </div>
  </div>
</footer>

<script>
  const endpoints = [
    { id: "TourismPlaces", name: "Tourism Places", url: `${baseURL}/TourismPlace/GetAllTourismt_Place` },
    { id: "Restaurants", name: "Restaurants", url: `${baseURL}/Services/GetRestuarant` },
    { id: "Hotels", name: "Hotels", url: `${baseURL}/Services/GetHotel` },
    { id: "Banks", name: "Banks", url: `${baseURL}/Bank/GetAllBanks` },
    { id: "EntertainmentPlace", name: "Entertainment Places", url: `${baseURL}/EntertainmentPlace/GetAllEmbasse` },
    { id: "Embasses", name: "Embasses", url: `${baseURL}/Embassies/GetAllEmbasse` }
  ];

  const urlMap = {
    "Tourism Places": `${baseURL}/TourismPlace/LoadTourismt_PlaceById/`,
    "Restaurants": `${baseURL}/Resturant/LoadRestaurantById/`,
    "Hotels": `${baseURL}/Hotels/LoadHotelById/`,
    "Banks": `${baseURL}/Bank/LoadBankById/`,
    "Entertainment Places": `${baseURL}/EntertainmentPlace/LoadEntertainmentPlaceById/`,
    "Embasses": `${baseURL}/Embassies/LoadEmbasseById/`
  };

  const sectionsContainer = document.getElementById("sections");

  function createCard(item, type) {
    const imgSrc = item.imageBytes
      ? `data:image/jpeg;base64,${item.imageBytes}`
      : "https://dummyimage.com/250x200/cccccc/000000&text=No+Image";

    let displayName = item.name || item.firstName || item.title || "No Name";
    let id = item.id || item.Id || item._id;
    let description = item.description || item.details || "A stunning destination worth exploring!";
    let price = item.price || "Price not available";
    let location = item.location || item.address || "Location not specified";
    let rating = item.rating || 3.5;

    const fullStars = Math.floor(rating);
    const halfStar = rating % 1 >= 0.5 ? 1 : 0;
    const emptyStars = 5 - fullStars - halfStar;

    let starsHtml = '';
    for (let i = 0; i < fullStars; i++) {
      starsHtml += '<i class="fas fa-star"></i>';
    }
    if (halfStar) {
      starsHtml += '<i class="fas fa-star-half-alt"></i>';
    }
    for (let i = 0; i < emptyStars; i++) {
      starsHtml += '<i class="far fa-star"></i>';
    }

    let url = urlMap[type] + id;

    return `
      <a href="Details.html?url=${encodeURIComponent(url)}" style="text-decoration:none; color:inherit;">
        <div class="card" title="${displayName}">
          <img src="${imgSrc}" alt="${type} Image" />
          <div class="card-body">
            <h6>${displayName}</h6>
            <p>${description}</p>
            <div class="details">
              <span>💰 ${price}</span> | <span>📍 ${location}</span>
            </div>
            <div class="rating">${starsHtml}</div>
          </div>
        </div>
      </a>
    `;
  }

  function setupSlider(containerId, cardCount) {
    if (cardCount <= 4) return;
    let offset = 0;
    const container = document.querySelector(`#${containerId} .card-slider`);
    setInterval(() => {
      const maxOffset = cardCount - 4;
      offset = (offset + 1) % (maxOffset + 1);
      const translateX = offset * -260;
      container.style.transform = `translateX(${translateX}px)`;
    }, 3000);
  }

  endpoints.forEach(({ id, name, url }) => {
    const sectionHTML = `
      <h2>${name}</h2>
      <div class="card-slider-container" id="${id}">
        <div class="card-slider"></div>
      </div>
    `;
    sectionsContainer.insertAdjacentHTML("beforeend", sectionHTML);

    fetch(url)
      .then(res => res.json())
      .then(data => {
        const slider = document.querySelector(`#${id} .card-slider`);
        data.forEach(item => {
          slider.insertAdjacentHTML("beforeend", createCard(item, name));
        });
        setupSlider(id, data.length);
      })
      .catch(err => {
        console.error(`❌ Failed to load ${name}:`, err);
        const container = document.querySelector(`#${id} .card-slider`);
        container.innerHTML = `<p style="color:red; padding:10px;">Failed to load ${name}</p>`;
      });
  });

  document.getElementById("heroStartJourney").addEventListener("click", async () => {
    try {
      const response = await fetch(`${baseURL}/User/Profile`, {
        credentials: "include"
      });

      if (!response.ok) {
        window.location.href = "login.html";
      } else {
        window.location.href = "Cities.html";
      }
    } catch (error) {
      console.error("❌ Error checking login:", error);
      window.location.href = "Login.html";
    }
  });

  async function logout() {
    try {
      sessionStorage.clear();
      localStorage.clear();

      const response = await fetch(`${baseURL}/User/Logout`, {
        method: "POST",
        credentials: "include"
      });

      if (response.ok) {
        window.location.href = "Login.html";
      } else {
        alert("Logout failed.");
      }
    } catch (error) {
      console.error("❌ Error logging out:", error);
      alert("An error occurred while logging out.");
    }
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
<df-messenger
  intent="WELCOME"
  chat-title="EgyptTourBot"
  agent-id="78ee9361-0667-4794-b1aa-e24d220ec8ed"
  language-code="en"
></df-messenger>
</body>
</html>